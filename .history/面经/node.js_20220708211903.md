# 事件循环
## Node.js 事件循环顺序：
- timers：执行到期的 setTimeout、setInterval 回调。
- pending callbacks：挂起的回调函数，执行延迟到下一个循环迭代的 I/O 回调。对某些系统操作（如TCP错误类型）执行回调。
- idle, prepare：空闲 准备，node 系统内部使用。
- poll：检索新的 I/O 事件。执行 I/O（例如文件、网络）的回调，除了 close，定时器和 setImmediate 以外的所有回调。其余情况 node 将在适当的时候在此阻塞。
- check：执行 setImmediate 回调。
- close callbacks：执行 close 事件回调，如 socket.on('close', ...)、http close等。
# commonjs
## 原理

# express
## express中间件
- 中间件是一种可以访问请求和响应对象的功能，也可以next在应用程序的请求-响应周期中使用该功能。
- 中间件有三个参数分别是依次为request对象（代表HTTP请求）、response对象（代表HTTP回应），next回调函数（代表下一个中间件）
- 可以使用应用程序对象上的use函数来调用中间件。
### 应用层中间件
- 应用级中间键绑定到app对象使用app.use和app.METHOD()-需要处理http请求的方法，例如GET、PUT、POST
### 路由层中间件
- 路由级中间件和应用级中间件类似，只不过是它绑定对象为express.Router()
- 路由级使用router.use()或router.VERB()加载
### 错误处理中间件
- 错误处理中间件有四个参数,定义错误处理中间件必须使用这四个参数。即使不需要next对象，也必须在参数中声明它，否者中间件会识别为一个常规中间件，不能处理错误
### 内置中间件
- express.static是 Express 唯一内置的中间件
- 基于 serve-static，负责在 Express 应用中提托管静态资源。
### 第三方中间件
- 通过使用第三方中间件从而为Express应用增加更多的功能
- 安装所需功能的node模块，并在应用中加载，可以在应用级中加载，也可以在路由级中加载


# 数据库
## 关系数据库与非关系数据库
- 关系型数据库-MySQL
  1. 在不同的引擎上有不同的存储方式。
  2. 查询语句是使用传统的sql语句，拥有较为成熟的体系，成熟度很高。
  3. 开源数据库的份额在不断增加，mysql的份额也在持续增长。
  4. 缺点就是在海量数据处理的时候效率会显著变慢。
- 非关系型数据库-MongoDB
  - 非关系型数据库(nosql),属于文档型数据库。先解释一下文档的数据库，即可以存放xml、json、bson类型的数据。这些数据具备自述性，呈现分层的树状数据结构。数据结构由键值(key=>value)对组成。
  1. 存储方式：虚拟内存+持久化。
  2. 查询语句：是独特的MongoDB的查询方式。
  3. 适合场景：事件的记录，内容管理或者博客平台等等。
  4. 架构特点：可以通过副本集，以及分片来实现高可用。
  5. 数据处理：数据是存储在硬盘上的，只不过需要经常读取的数据会被加载到内存中，将数据存储在物理内存中，从而达到高速读写。
  6. 成熟度与广泛度：新兴数据库，成熟度较低，Nosql数据库中最为接近关系型数据库，比较完善的DB之一，适用人群不断在增长。
## 为什么选择MongoDB，相比MySQL有何优势
- 优势
  - 弱一致性（最终一致），更能保证用户的访问速度
  - 文档结构的存储方式，能够更便捷的获取数据。
  - 内置GridFS，支持大容量的存储。
  - 内置Sharding。实现负载均衡
  - 第三方支持丰富（与其他的NoSQL相比）
  - 性能优越
    - 千万级别的文档对象，近10G的数据，对有索引的ID的查询不会比mysql慢，而对非索引字段的查询，则是全面胜出
    - CPU占用并不高
- 劣势
  - 不支持事务操作。
  - 占用空间过大
    - 空间的预分配
    - 字段名所占用
    - 删除记录不释放空间
  - 没有如MySQL那样成熟的维护工具
